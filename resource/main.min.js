var headerHeight=60;var senBodyData;var currentPageNum=1;var mountedApp=!1;function loadBasicData(){reqwest({url:'/data/basic.json?v=fc9c07a1b4afed05426f0d3fbbd454ba',type:'json',method:'get',success:function(resp){senBasicData=resp;var extraData={isShrinkedHeader:!1,isLoading:!0,isMobileMenu:!1,firstRun:!1,CurrentPage:"index",coverImg:{},hasCoverImg:!1,toc:"",activeToc:-1,tocItems:[],};senBasicData.status=extraData;if(currentMode!='post'){loadContentData()}else{embedContentData()}},error:function(){alert("Data error...")}})}
function loadContentData(){reqwest({url:'/data/'+dataSource(),type:'json',method:'get',success:function(resp){senBasicData.bodydata=resp;renderNow()},error:function(){if(!mountedApp){alert("Data error...")}}})}
function dataSource(){switch(currentMode){case 'main':if(location.hash.indexOf('#page/')==0){currentPageNum=Math.floor(location.hash.substring(6))}
var dataSrc='page-'+currentPageNum+'.json?v=fc9c07a1b4afed05426f0d3fbbd454ba';break;case 'tags':var dataSrc='tags.json?v=fc9c07a1b4afed05426f0d3fbbd454ba';senBasicData.status.CurrentPage='tags';break;case 'archive':var dataSrc='archive.json?v=fc9c07a1b4afed05426f0d3fbbd454ba';senBasicData.status.CurrentPage='archive';break;default:var dataSrc='page-1.json?v=fc9c07a1b4afed05426f0d3fbbd454ba'}
return dataSrc}
function turnPage(pn){if(currentMode=='main'){senBasicData.status.isLoading=!0;reqwest({url:'/data/page-'+pn+'.json?v=fc9c07a1b4afed05426f0d3fbbd454ba',type:'json',method:'get',success:function(resp){senBasicData.bodydata=resp;location.hash="#page/"+pn;senBasicData.status.isLoading=!1;document.body.scrollIntoView({behavior:'smooth'})}})}}
function renderNow(){var tempData={HeaderZone:"<header id=\"sn-header\" class=\"row\" :class=\"{'sn-animation-header': status.firstRun, 'sn-shrinked-header': status.isShrinkedHeader}\" v-if=\"!status.isLoading\"> <div id=\"sn-logo\" class=\"width-fixed\"><h1 @click=\"goHome\"><span aria-hidden=\"true\" class=\"sn-h1-deco\">「</span> {{ Site.SiteName }} <span aria-hidden=\"true\" class=\"sn-h1-deco\">」</span></h1></div> <nav class=\"width-12\" :class=\"{'sn-menu': status.isMobileMenu}\"> <ul> <li v-for=\"nav in Navs\" :key=\"nav.id\" :class=\"isActivePage(nav.id)\"> <a :href=\"nav.url\" :target=\"nav.target\">{{ nav.text }}</a> </li> <li> <span id=\"switch-dark\" @click=\"loadScheme('dark')\"><i class=\"fa fa-moon-o\" aria-hidden=\"true\"></i></span><span id=\"switch-light\" @click=\"loadScheme('light')\"><i class=\"fa fa-sun-o\" aria-hidden=\"true\"></i></span></li> </li> </ul></nav> <div id=\"sn-btn-menu\" @click=\"toggleMenu\"> <i class=\"fa fa-bars\" aria-hidden=\"true\"></i> </div> <div id=\"sn-sidebar\" :class=\"{'sn-sidebar-open': status.isMobileMenu, 'sn-animation-sidebar': status.firstRun}\"> <div class=\"sn-side-item\" id=\"sn-side-TOC\" v-html=\"status.toc\" v-if=\"status.toc\"> </div><div class=\"sn-side-item\" v-if=\"!status.toc\"> <h4><i class=\"fa fa-user-o\" aria-hidden=\"true\"></i> About </h4> <div class=\"sn-side-content\"> <img v-bind:src=\"Site.Icon\" alt=\"User Avatar\" class=\"sn-side-icon\"> {{ Site.SelfIntro }} <div class=\"sn-side-stat\"> <div><span class=\"sn-side-figure\">{{ Stats.TotalArticle }}</span><span>Articles</span></div> <div><span class=\"sn-side-figure\">{{ howManyDays }}</span><span>Days</span></div> <div><span class=\"sn-side-figure\">{{ Stats.TotalTag }}</span><span>Tags</span></div> </div> </div> </div> <div class=\"sn-side-item\" v-if=\"!status.toc\"> <h4><i class=\"fa fa-comment-o\" aria-hidden=\"true\"></i> Connect </h4> <div class=\"sn-side-content\"> <ul class=\"sn-side-social\"> <li v-for=\"sl in Social\"> <a :href=\"sl.url\" target=\"_blank\" v-bind:title=\"sl.text\"><i class=\"fa\" v-bind:class=\"'fa-'+sl.icon\" aria-hidden=\"true\"></i></a> </li> </ul> </div> </div> <div class=\"sn-side-item\" v-if=\"!status.toc\"> <h4><i class=\"fa fa-external-link\" aria-hidden=\"true\"></i> Links </h4> <div class=\"sn-side-content\"> <ul class=\"sn-side-external\"> <li v-for=\"sl in External\"> <i class=\"fa fa-angle-right\" aria-hidden=\"true\"></i> <a :href=\"sl.url\" target=\"_blank\">{{ sl.text }}</a> </li> </ul> </div> </div> </div> </header>",MainZone:"<main :class=\"{'sn-main': status.isMobileMenu, 'sn-animation-main': status.firstRun}\"v-if=\"!status.isLoading\"> <article v-for=\"article in articles\" :key=\"article.fName\" class=\"sn-article-wrap\"> <div class=\"sn-time\">{{ article.cTime }}</div> <div><h2 class=\"sn-title\"><a :href=\"Site.BaseURL+'/post/'+article.fName+'.html'\">{{ article.artTitle }}</a></h2></div> <div class=\"sn-body\" v-html=\"highlight(article.artSummary)\"> </div> <div v-if=\"article.artSummary != article.artContent\"><button class=\"small sn-btn-more\"><a :href=\"Site.BaseURL+'/post/'+article.fName+'.html#more'\"><i class=\"fa fa-caret-right\"></i> More... </a></button></div> <div class=\"sn-tags\"> <span class=\"sn-tag\" v-for=\"tag in article.artTags\"><a :href=\"Site.BaseURL+'/tags.html#'+tag\">#{{ tag }}</a></span> </div> </article> <div id=\"page-switcher\"> <page-bar inline-template :site=\"Site\" :status=\"status\" :total-page=\"TotalPage\"> <ul class=\"sn-pages\"> <li v-if=\"CurrentPageNum != 1\" @click=\"goPage(-1)\"><i class=\"fa fa-chevron-left\"></i></li><li v-for=\"(item, index) in pages\" :key=\"index\"@click=\"goPage(item)\"><span :class=\"{'sn-page-actived': item == CurrentPageNum}\">{{ item }}</span></li><li v-if=\"CurrentPageNum != TotalPage\" @click=\"goPage(0)\"><i class=\"fa fa-chevron-right\"></i></li> </ul> </page-bar> </div> </main>",FooterZone:"<footer v-if=\"!status.isLoading\"> <div id=\"sn-copyright\" v-html=\"Site.CopyRight\"></div><div id=\"sn-go-top\" v-if=\"status.isShrinkedHeader\" @click=\"goToTop\"><i class=\"fa fa-arrow-circle-up\" aria-hidden=\"true\"></i></div></footer>",PostZone:"<main :class=\"{'sn-main': status.isMobileMenu, 'sn-cover-pushdown': status.hasCoverImg, 'sn-animation-main': status.firstRun}\" v-if=\"!status.isLoading\"> <div id=\"sn-cover\" :style=\"status.coverImg\"><div class=\"sn-cover-time\">{{ articles.cTime }}</div><div class=\"sn-cover-title\">{{ articles.artTitle }}</div></div> <article class=\"artContainer singleArticle\"> <div class=\"sn-time\">{{ articles.cTime }}</div> <div> <h2 class=\"sn-title\">{{ articles.artTitle }}</h2> </div> <div class=\"sn-body\" v-html=\"highlight(articles.artContent)\"> </div><div class=\"sn-tags\"> <span class=\"sn-tag\" v-for=\"tag in articles.artTags\"><a :href=\"Site.BaseURL+'/tags.html#'+tag\">#{{ tag }}</a></span> </div> <div id=\"gitalk-container\"></div> </article> </main>",TagsZone:"<main :class=\"{'sn-main': status.isMobileMenu}\"v-if=\"!status.isLoading\"> <article v-for=\"entry in Entries\" :key=\"entry.eID\"> <div><h4 class=\"sn-entry\">{{ entry.eID }}</h4></div> <div class=\"sn-body\"> <ul class=\"sn-list\"> <li v-for=\"article in entry.eArticles\"> <span class=\"sn-item-title\"><a :href=\"Site.BaseURL+'/post/'+article.fName+'.html'\">{{ article.artTitle }}</a></span> <span class=\"sn-item-extra\">({{ article.cTime }})</span> </li> </ul> </div> </article> </main>",ArchiveZone:"<main :class=\"{'sn-main': status.isMobileMenu}\"v-if=\"!status.isLoading\"> <article v-for=\"entry in Entries\" :key=\"entry.eID\" class=\"sn-archive\"> <div class=\"sn-archive-wrap\" :class=\"{'sn-archive-wrap-shrinked': status.isMobileMenu}\"> <div class=\"sn-archive-time\"><h4 class=\"sn-entry\">{{ entry.eID | ymformat }}</h4></div> <div class=\"sn-archive-timeline\" v-if=\"!status.isMobileMenu\"><span class=\"sn-archive-dot\"></span></div> <div class=\"sn-body sn-archive-body\"> <ul class=\"sn-list\"> <li v-for=\"article in entry.eArticles\"> <span class=\"sn-item-title\"><a :href=\"Site.BaseURL+'/post/'+article.fName+'.html'\">{{ article.artTitle }}</a></span> </li> </ul> </div> </div> </article> </main>"};Vue.component('header-zone',{props:['Site','Navs','Social','External','Stats','status'],methods:{isActivePage:function(navid){return this.status.CurrentPage==navid?'sn-active-page':''},toggleMenu:function(){this.status.isMobileMenu=this.status.isMobileMenu?!1:!0},goHome:function(){window.location.href=this.Site.BaseURL+'/'}},template:tempData.HeaderZone,mounted:function(){this.status.firstRun=!0},computed:{howManyDays(){let today=new Date();return Math.floor((today.getTime()/1000-this.Stats.DaysEstablished)/3600/24)}}});Vue.component('main-zone',{props:['Site','status','articles','TotalPage'],template:tempData.MainZone});Vue.component('page-bar',{props:['Site','status','TotalPage'],data:function(){return{CurrentPageNum:currentPageNum}},methods:{goPage:function(pn){if(pn==-1){this.CurrentPageNum--;currentPageNum--;turnPage(currentPageNum)}else if(pn==0){this.CurrentPageNum++;currentPageNum++;turnPage(currentPageNum)}else if(pn!='...'&&pn!=currentPageNum){this.CurrentPageNum=pn;currentPageNum=pn;turnPage(currentPageNum)}}},computed:{pages(){let c=this.CurrentPageNum;let t=this.TotalPage;let prg=2;let rs=[1];if(t<prg*2+2){for(let m=2;m<=t;m++){rs.push(m)}
return rs}
if(c<prg+1){prg=prg+(prg-c+1)}
let mid=[];let more1=!1;let more2=!1;for(let m=2;m<t;m++){if(m>c+prg){more2=!0;break}
if(m<c-prg){more1=!0;continue}else{mid.push(m)}}
if(more1){rs.push('...')}
rs=rs.concat(mid);if(more2){rs.push('...')}
if(t>1){rs.push(t)}
return rs}}});Vue.component('footer-zone',{props:['Site','status'],template:tempData.FooterZone,methods:{goToTop:function(){document.documentElement.scrollTop=0}}});Vue.component('post-zone',{props:['Site','status','articles'],template:tempData.PostZone});Vue.component('tags-zone',{props:['Site','status'],data:function(){var senBodyData=senBasicData.bodydata;var hs=location.hash;if(hs!=''||hs!='#'){hs=decodeURI(hs.substring(1));for(var i in senBodyData){if(senBodyData[i].eID==hs){var bSenData=[];bSenData[0]=senBodyData[i];return{Entries:bSenData}}}}
return{Entries:senBodyData}},template:tempData.TagsZone});Vue.component('archive-zone',{props:['Site','status'],data:function(){var senBodyData=senBasicData.bodydata;var hs=location.hash;if(hs!=''||hs!='#'){hs=decodeURI(hs.substring(1));for(var i in senBodyData){if(senBodyData[i].eID==hs){var bSenData=[];bSenData[0]=senBodyData[i];return{Entries:bSenData}}}}
return{Entries:senBodyData}},filters:{ymformat:function(val){val=val.toString();return val.substring(0,4)+'-'+val.substring(4)}},template:tempData.ArchiveZone});Vue.prototype.highlight=function(val){val=val.replace(/<pre><code>([\s\S]+?)<\/code><\/pre>/gm,function(w,code){var code2=code.replace(/&lt;/gm,"<").replace(/&gt;/gm,">");var valHL=hljs.highlightAuto(code2,['php','javascript','html','sh']);return"<pre><code>"+valHL.value+"</code></pre>"});val=val.replace(/<pre><code class="language-([0-9A-Za-z]+)">([\s\S]+?)<\/code><\/pre>/gm,function(w,lang,code){var code2=code.replace(/&lt;/gm,"<").replace(/&gt;/gm,">");var valHL=hljs.highlightAuto(code2,[lang]);return"<pre><code>"+valHL.value+"</code></pre>"});val=val.replace(/<img src="([\s\S]+?)"([\s\S]+?)>/gm,function(w,url){return"<a href=\""+url+"\" target='_blank'>"+w+"</a>"});return val};var app=new Vue({el:'#main-canvas',data:senBasicData,created:function(){console.log(senBasicData);document.getElementById('main-canvas').style.display='block';document.getElementById('body-wrapper').style.display='none';window.addEventListener('scroll',this.autoShrinkHeader)},mounted:function(){this.$nextTick(function(){this.status.isLoading=!1;var canvasRendered=this.$el;if(currentMode=='post'){window.addEventListener("hashchange",function(){var chapterBody=canvasRendered.querySelector(location.hash);document.documentElement.scrollTop=chapterBody.offsetTop-headerHeight},!1);if(senBasicData.bodydata.aSet.cover){this.status.hasCoverImg=!0;this.status.coverImg={display:"block",background:"url("+senBasicData.bodydata.aSet.cover+")","background-size":"cover"}}
if(document.getElementById("article-toc")){var allToc=document.getElementById("article-toc").querySelectorAll("li");document.getElementById('body-wrapper').remove();var toc="<ul>";var tocItems=[];allToc.forEach(function(sToc,idx){toc+=sToc.outerHTML.replace(/<li>/g,"<li id=\"sn-TocItem-"+idx+"\">")});toc+="</ul>";setTimeout(function(){allToc.forEach(function(sToc,idx){var scr=sToc.querySelector('a').href.split('#')[1];tocItems[idx]=document.getElementById(scr).offsetTop})},2000);this.status.toc=toc;this.status.tocItems=tocItems}}});mountedApp=!0},updated:function(){},computed:{currentActiveMode:function(){return(currentMode+"-zone")}},methods:{autoShrinkHeader:function(){this.status.firstRun=!1;var scrolled=document.documentElement.scrollTop||document.body.scrollTop;if(scrolled>headerHeight){this.status.isShrinkedHeader=!0}else{this.status.isShrinkedHeader=!1}
var thisScrolled=-1;this.status.tocItems.forEach(function(scr,idx){if(scrolled>=scr-headerHeight){thisScrolled=idx}
if(scrolled<scr-headerHeight){return}});if(thisScrolled!=this.status.activeToc){if(this.status.activeToc!=-1){document.getElementById("sn-TocItem-"+this.status.activeToc).classList.remove("sn-toc-active")}
if(thisScrolled!=-1){document.getElementById("sn-TocItem-"+thisScrolled).classList.add("sn-toc-active")}
this.status.activeToc=thisScrolled}},isActiveToc:function(cToc){if(cToc==this.status.activeToc){return!0}else{return!1}}}})}
loadBasicData()